2025-03-26 21:17:33,544 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-03-26 21:17:33,544 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-26 21:17:33,544 - speechbrain.core - INFO - Beginning experiment!
2025-03-26 21:17:33,544 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-26 21:17:33,584 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-26 21:17:33,738 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-26 21:17:33,854 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-26 21:17:33,856 - speechbrain.utils.superpowers - DEBUG - b70e0b4


2025-03-26 21:17:33,857 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-26 21:17:33,857 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-26 21:17:33,872 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-26 21:17:33,881 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:17:33,881 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-26 21:17:33,881 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:17:34,004 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-26 21:17:34,004 - filelock - DEBUG - Attempting to acquire lock 135016386035376 on results/1993/save/wav2vec2_checkpoint/.locks/models--facebook--wav2vec2-base/6180a447f726e4a2ab8b50effaf0a96f5b161489c620087c3b05418f0179f875.lock
2025-03-26 21:17:34,004 - filelock - DEBUG - Lock 135016386035376 acquired on results/1993/save/wav2vec2_checkpoint/.locks/models--facebook--wav2vec2-base/6180a447f726e4a2ab8b50effaf0a96f5b161489c620087c3b05418f0179f875.lock
2025-03-26 21:17:34,005 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): cdn-lfs.hf.co:443
2025-03-26 21:17:34,122 - urllib3.connectionpool - DEBUG - https://cdn-lfs.hf.co:443 "GET /facebook/wav2vec2-base/6180a447f726e4a2ab8b50effaf0a96f5b161489c620087c3b05418f0179f875?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27model.safetensors%3B+filename%3D%22model.safetensors%22%3B&Expires=1743022506&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc0MzAyMjUwNn19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy5oZi5jby9mYWNlYm9vay93YXYydmVjMi1iYXNlLzYxODBhNDQ3ZjcyNmU0YTJhYjhiNTBlZmZhZjBhOTZmNWIxNjE0ODljNjIwMDg3YzNiMDU0MThmMDE3OWY4NzU~cmVzcG9uc2UtY29udGVudC1kaXNwb3NpdGlvbj0qIn1dfQ__&Signature=B6XEz-bvik4e-oahd8v3ozLcHFxO74lg7Tirrb7LSx44wKCxTxH3eVbNuIVVpKHVROzp5cwlLQ9PJ8K3zk6wCtRJnSDDKIwMhzdoZagaJq3Y85NhnnRmyubBiLhGD3x2FYkKk31zm00jzLw6AUvMQEriUIKW0joJvupchqjwS4OAYHQElkfHz1r~k9pph1waxJDPPu6mcPodelCB-HaNcDCYqx6kZI79bYL1xBcVUVl7GIXYoCAndoY704lV9HpRpVmlrsBfsZr5RVHyzXBUHMLnnw-uFFD6lKswOKXvsGJPINSfLilCEs~BwHd9MS6dVsc08~JBuJXUBN7Yx6MPNg__&Key-Pair-Id=K3RPWS32NSSJCE HTTP/1.1" 200 380204696
2025-03-26 21:17:34,203 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-26 21:17:34,205 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-26 21:17:34,206 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-26 21:17:34,207 - speechbrain.utils.checkpoints - INFO - Would load a checkpoint here, but none found yet.
2025-03-26 21:17:34,207 - speechbrain.utils.epoch_loop - INFO - Going into epoch 1
2025-03-26 21:17:34,226 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 273, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1438, in _fit_train
    for batch in t:
  File "/home/zsombor/.local/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1480, in _next_data
    return self._process_data(data)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1505, in _process_data
    data.reraise()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/_utils.py", line 733, in reraise
    raise exception
AssertionError: Caught AssertionError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/dataio/dataset.py", line 167, in __getitem__
    return self.pipeline.compute_outputs({"id": data_id, **data_point})
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 507, in compute_outputs
    return self._compute(data, self._exec_order, self.output_mapping)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 539, in _compute
    values = item(*args)  # Call the DynamicItem to produce output
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 73, in __call__
    return self.func(*args)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 169, in audio_pipeline
    assert os.path.exists(wav), f"File not found: {wav}"
AssertionError: File not found: /MELD-wav16k/wav16k_train/dia0681_utt00.wav

2025-03-26 21:17:48,129 - filelock - DEBUG - Attempting to release lock 135016386035376 on results/1993/save/wav2vec2_checkpoint/.locks/models--facebook--wav2vec2-base/6180a447f726e4a2ab8b50effaf0a96f5b161489c620087c3b05418f0179f875.lock
2025-03-26 21:17:48,130 - filelock - DEBUG - Lock 135016386035376 released on results/1993/save/wav2vec2_checkpoint/.locks/models--facebook--wav2vec2-base/6180a447f726e4a2ab8b50effaf0a96f5b161489c620087c3b05418f0179f875.lock
2025-03-26 21:18:47,556 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_jit_profiling, disable_cudnn_benchmarking]
2025-03-26 21:18:47,556 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-26 21:18:47,556 - speechbrain.core - INFO - Beginning experiment!
2025-03-26 21:18:47,556 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-26 21:18:47,572 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-26 21:18:47,723 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-26 21:18:47,872 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-26 21:18:47,873 - speechbrain.utils.superpowers - DEBUG - b70e0b4


2025-03-26 21:18:47,874 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-26 21:18:47,874 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-26 21:18:47,897 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:18:47,897 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-26 21:18:47,897 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:18:47,939 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-26 21:18:48,078 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-26 21:18:48,221 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-26 21:18:48,223 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-26 21:18:48,223 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-26 21:18:48,224 - speechbrain.utils.checkpoints - INFO - Would load a checkpoint here, but none found yet.
2025-03-26 21:18:48,224 - speechbrain.utils.epoch_loop - INFO - Going into epoch 1
2025-03-26 21:18:48,243 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 274, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1438, in _fit_train
    for batch in t:
  File "/home/zsombor/.local/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1480, in _next_data
    return self._process_data(data)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1505, in _process_data
    data.reraise()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/_utils.py", line 733, in reraise
    raise exception
AssertionError: Caught AssertionError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/dataio/dataset.py", line 167, in __getitem__
    return self.pipeline.compute_outputs({"id": data_id, **data_point})
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 507, in compute_outputs
    return self._compute(data, self._exec_order, self.output_mapping)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 539, in _compute
    values = item(*args)  # Call the DynamicItem to produce output
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 73, in __call__
    return self.func(*args)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 169, in audio_pipeline
    assert os.path.exists(wav), f"File not found: {wav}"
AssertionError: File not found: /MELD-wav16k/wav16k_train/dia0681_utt00.wav

2025-03-26 21:18:48,655 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-26 21:18:58,519 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-03-26 21:18:58,520 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-26 21:18:58,520 - speechbrain.core - INFO - Beginning experiment!
2025-03-26 21:18:58,520 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-26 21:18:58,542 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-26 21:18:58,692 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-26 21:18:58,818 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-26 21:18:58,819 - speechbrain.utils.superpowers - DEBUG - b70e0b4


2025-03-26 21:18:58,820 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-26 21:18:58,820 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-26 21:18:58,843 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-26 21:18:58,843 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:18:58,844 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-26 21:18:58,844 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:18:58,995 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-26 21:18:59,127 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-26 21:18:59,162 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-26 21:18:59,165 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-26 21:18:59,166 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-26 21:18:59,167 - speechbrain.utils.checkpoints - INFO - Would load a checkpoint here, but none found yet.
2025-03-26 21:18:59,167 - speechbrain.utils.epoch_loop - INFO - Going into epoch 1
2025-03-26 21:18:59,187 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 274, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1438, in _fit_train
    for batch in t:
  File "/home/zsombor/.local/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1480, in _next_data
    return self._process_data(data)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1505, in _process_data
    data.reraise()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/_utils.py", line 733, in reraise
    raise exception
soundfile.LibsndfileError: <unprintable LibsndfileError object>
2025-03-26 21:19:15,562 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-03-26 21:19:15,562 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-26 21:19:15,562 - speechbrain.core - INFO - Beginning experiment!
2025-03-26 21:19:15,562 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-26 21:19:15,752 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-26 21:19:15,868 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-26 21:19:15,869 - speechbrain.utils.superpowers - DEBUG - b70e0b4


2025-03-26 21:19:15,870 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-26 21:19:15,870 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-26 21:19:15,894 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:19:15,894 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-26 21:19:15,894 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-26 21:19:15,904 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-26 21:19:16,058 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-26 21:19:16,195 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-26 21:19:16,217 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-26 21:19:16,219 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-26 21:19:16,220 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-26 21:19:16,220 - speechbrain.utils.checkpoints - INFO - Would load a checkpoint here, but none found yet.
2025-03-26 21:19:16,220 - speechbrain.utils.epoch_loop - INFO - Going into epoch 1
2025-03-26 21:19:16,240 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 273, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1438, in _fit_train
    for batch in t:
  File "/home/zsombor/.local/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1480, in _next_data
    return self._process_data(data)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1505, in _process_data
    data.reraise()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/_utils.py", line 733, in reraise
    raise exception
AssertionError: Caught AssertionError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/dataio/dataset.py", line 167, in __getitem__
    return self.pipeline.compute_outputs({"id": data_id, **data_point})
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 507, in compute_outputs
    return self._compute(data, self._exec_order, self.output_mapping)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 539, in _compute
    values = item(*args)  # Call the DynamicItem to produce output
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 73, in __call__
    return self.func(*args)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 169, in audio_pipeline
    assert os.path.exists(wav), f"File not found: {wav}"
AssertionError: File not found: /MELD-wav16k/wav16k_train/dia0681_utt00.wav

2025-03-26 21:19:16,337 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-27 19:54:30,647 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_jit_profiling, disable_cudnn_benchmarking]
2025-03-27 19:54:30,647 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-27 19:54:30,647 - speechbrain.core - INFO - Beginning experiment!
2025-03-27 19:54:30,647 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-27 19:54:30,676 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-27 19:54:30,826 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-27 19:54:30,936 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-27 19:54:30,937 - speechbrain.utils.superpowers - DEBUG - 166a33d


2025-03-27 19:54:30,938 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-27 19:54:30,938 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-27 19:54:30,960 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-27 19:54:30,960 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-27 19:54:30,960 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-27 19:54:30,977 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-27 19:54:31,111 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-27 19:54:31,245 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-27 19:54:31,269 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-27 19:54:31,271 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-27 19:54:31,272 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-27 19:54:31,272 - speechbrain.utils.checkpoints - INFO - Would load a checkpoint here, but none found yet.
2025-03-27 19:54:31,272 - speechbrain.utils.epoch_loop - INFO - Going into epoch 1
2025-03-27 19:54:31,288 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 19:54:31,290 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:02:58,069 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:02:58,072 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:03:17,217 - speechbrain.utils.train_logger - INFO - Epoch: 1, lr: 1.00e-04, wave2vec_lr: 1.00e-05 - train loss: 1.80 - valid loss: 1.92, valid error_rate: 5.76e-01
2025-03-27 20:03:17,968 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+20-03-17+00
2025-03-27 20:03:17,969 - speechbrain.utils.epoch_loop - INFO - Going into epoch 2
2025-03-27 20:03:17,996 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:03:17,997 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:11:45,201 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:11:45,204 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:12:04,239 - speechbrain.nnet.schedulers - INFO - Changing lr from 0.0001 to 9e-05
2025-03-27 20:12:04,239 - speechbrain.nnet.schedulers - INFO - Changing lr from 1e-05 to 9e-06
2025-03-27 20:12:04,239 - speechbrain.utils.train_logger - INFO - Epoch: 2, lr: 1.00e-04, wave2vec_lr: 1.00e-05 - train loss: 1.73 - valid loss: 1.69, valid error_rate: 5.76e-01
2025-03-27 20:12:04,990 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+20-12-04+00
2025-03-27 20:12:05,069 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+20-03-17+00
2025-03-27 20:12:05,069 - speechbrain.utils.epoch_loop - INFO - Going into epoch 3
2025-03-27 20:12:05,093 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:12:05,095 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:20:33,690 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:20:33,692 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:20:52,118 - speechbrain.nnet.schedulers - INFO - Changing lr from 9e-05 to 8.1e-05
2025-03-27 20:20:52,118 - speechbrain.nnet.schedulers - INFO - Changing lr from 9e-06 to 8.1e-06
2025-03-27 20:20:52,118 - speechbrain.utils.train_logger - INFO - Epoch: 3, lr: 9.00e-05, wave2vec_lr: 9.00e-06 - train loss: 1.69 - valid loss: 1.91, valid error_rate: 5.76e-01
2025-03-27 20:20:52,862 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+20-20-52+00
2025-03-27 20:20:52,943 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+20-12-04+00
2025-03-27 20:20:52,944 - speechbrain.utils.epoch_loop - INFO - Going into epoch 4
2025-03-27 20:20:52,967 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:20:52,969 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:29:06,030 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:29:06,032 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:29:24,414 - speechbrain.nnet.schedulers - INFO - Changing lr from 8.1e-05 to 7.3e-05
2025-03-27 20:29:24,414 - speechbrain.nnet.schedulers - INFO - Changing lr from 8.1e-06 to 7.3e-06
2025-03-27 20:29:24,415 - speechbrain.utils.train_logger - INFO - Epoch: 4, lr: 8.10e-05, wave2vec_lr: 8.10e-06 - train loss: 1.70 - valid loss: 1.65, valid error_rate: 5.76e-01
2025-03-27 20:29:25,064 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+20-29-24+00
2025-03-27 20:29:25,148 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+20-20-52+00
2025-03-27 20:29:25,148 - speechbrain.utils.epoch_loop - INFO - Going into epoch 5
2025-03-27 20:29:25,173 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:29:25,175 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:37:38,809 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:37:38,811 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:37:57,208 - speechbrain.nnet.schedulers - INFO - Changing lr from 7.3e-05 to 6.6e-05
2025-03-27 20:37:57,208 - speechbrain.nnet.schedulers - INFO - Changing lr from 7.3e-06 to 6.6e-06
2025-03-27 20:37:57,208 - speechbrain.utils.train_logger - INFO - Epoch: 5, lr: 7.29e-05, wave2vec_lr: 7.29e-06 - train loss: 1.69 - valid loss: 1.69, valid error_rate: 5.76e-01
2025-03-27 20:37:57,840 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+20-37-57+00
2025-03-27 20:37:57,924 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+20-29-24+00
2025-03-27 20:37:57,925 - speechbrain.utils.epoch_loop - INFO - Going into epoch 6
2025-03-27 20:37:57,950 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:37:57,952 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:46:19,177 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:46:19,180 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:46:38,239 - speechbrain.nnet.schedulers - INFO - Changing lr from 6.6e-05 to 5.9e-05
2025-03-27 20:46:38,240 - speechbrain.nnet.schedulers - INFO - Changing lr from 6.6e-06 to 5.9e-06
2025-03-27 20:46:38,240 - speechbrain.utils.train_logger - INFO - Epoch: 6, lr: 6.56e-05, wave2vec_lr: 6.56e-06 - train loss: 1.69 - valid loss: 1.75, valid error_rate: 6.82e-01
2025-03-27 20:46:39,018 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+20-46-38+00
2025-03-27 20:46:39,045 - speechbrain.utils.epoch_loop - INFO - Going into epoch 7
2025-03-27 20:46:39,069 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:46:39,070 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:46:39,702 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 32, in compute_forward
    outputs = self.hparams.avg_pool(outputs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/nnet/pooling.py", line 314, in forward
    actual_size = int(torch.round(lengths[snt_id] * x.shape[1]))
KeyboardInterrupt
2025-03-27 20:47:15,640 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-03-27 20:47:15,640 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-27 20:47:15,640 - speechbrain.core - INFO - Beginning experiment!
2025-03-27 20:47:15,640 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-27 20:47:15,763 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-27 20:47:15,924 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-27 20:47:15,931 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-27 20:47:15,932 - speechbrain.utils.superpowers - DEBUG - 166a33d


2025-03-27 20:47:15,933 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-27 20:47:15,933 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-27 20:47:15,955 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-27 20:47:15,955 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-27 20:47:15,955 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-27 20:47:16,066 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-27 20:47:16,246 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-27 20:47:17,742 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-27 20:47:17,744 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-27 20:47:17,744 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-27 20:47:17,746 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+20-46-38+00
2025-03-27 20:47:18,203 - speechbrain.utils.epoch_loop - INFO - Going into epoch 7
2025-03-27 20:47:18,231 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:47:18,231 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:51:35,223 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1822, in forward
    encoder_outputs = self.encoder(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1060, in forward
    layer_outputs = layer(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 942, in forward
    hidden_states = hidden_states + self.feed_forward(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 909, in forward
    hidden_states = self.intermediate_dense(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 74.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 42.00 MiB is free. Of the allocated memory 15.13 GiB is allocated by PyTorch, and 283.46 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-03-27 20:52:24,189 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, disable_cudnn_benchmarking, allow_tf32]
2025-03-27 20:52:24,189 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-27 20:52:24,189 - speechbrain.core - INFO - Beginning experiment!
2025-03-27 20:52:24,189 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-27 20:52:24,209 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-27 20:52:24,374 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-27 20:52:24,483 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-27 20:52:24,484 - speechbrain.utils.superpowers - DEBUG - 166a33d


2025-03-27 20:52:24,485 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-27 20:52:24,485 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-27 20:52:24,507 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-27 20:52:24,507 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-27 20:52:24,507 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-27 20:52:24,522 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-27 20:52:24,653 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-27 20:52:24,788 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-27 20:52:25,060 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-27 20:52:25,062 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-27 20:52:25,063 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-27 20:52:25,064 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+20-46-38+00
2025-03-27 20:52:28,129 - speechbrain.utils.epoch_loop - INFO - Going into epoch 7
2025-03-27 20:52:28,152 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:52:28,154 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:59:11,781 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:59:11,783 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:59:28,424 - speechbrain.utils.train_logger - INFO - Epoch: 7, lr: 5.90e-05, wave2vec_lr: 5.90e-06 - train loss: 1.56 - valid loss: 1.67, valid error_rate: 5.76e-01
2025-03-27 20:59:29,085 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+20-59-28+00
2025-03-27 20:59:29,193 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+20-46-38+00
2025-03-27 20:59:29,207 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+20-37-57+00
2025-03-27 20:59:29,208 - speechbrain.utils.epoch_loop - INFO - Going into epoch 8
2025-03-27 20:59:29,248 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 20:59:29,252 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 21:14:30,247 - speechbrain.utils.checkpoints - DEBUG - Saved an intra-epoch checkpoint in results/1993/save/CKPT+2025-03-27+21-14-29+00
2025-03-27 21:15:10,288 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 21:15:10,291 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 21:15:41,909 - speechbrain.nnet.schedulers - INFO - Changing lr from 5.9e-05 to 5.3e-05
2025-03-27 21:15:41,909 - speechbrain.nnet.schedulers - INFO - Changing lr from 5.9e-06 to 5.3e-06
2025-03-27 21:15:41,909 - speechbrain.utils.train_logger - INFO - Epoch: 8, lr: 5.90e-05, wave2vec_lr: 5.90e-06 - train loss: 1.56 - valid loss: 1.64, valid error_rate: 5.76e-01
2025-03-27 21:15:42,966 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-27 21:15:43,077 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+21-14-29+00
2025-03-27 21:15:43,098 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+20-59-28+00
2025-03-27 21:15:43,098 - speechbrain.utils.epoch_loop - INFO - Going into epoch 9
2025-03-27 21:15:43,125 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 21:15:43,133 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-27 21:15:44,613 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1248, in fit_batch
    return loss.detach().cpu()
KeyboardInterrupt
2025-03-28 18:43:18,383 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_jit_profiling, disable_cudnn_benchmarking]
2025-03-28 18:43:18,384 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 18:43:18,384 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 18:43:18,384 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 18:43:18,477 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 18:43:18,624 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 18:43:18,763 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 18:43:18,823 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 18:43:18,824 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 18:43:18,826 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 18:43:18,826 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 18:43:18,855 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:43:18,855 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 18:43:18,855 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:43:18,892 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 18:43:20,520 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 18:43:20,522 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 18:43:20,522 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 18:43:20,524 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-28 18:43:24,248 - speechbrain.utils.epoch_loop - INFO - Going into epoch 9
2025-03-28 18:43:24,279 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:43:24,280 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:43:27,159 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1822, in forward
    encoder_outputs = self.encoder(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1060, in forward
    layer_outputs = layer(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 942, in forward
    hidden_states = hidden_states + self.feed_forward(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 909, in forward
    hidden_states = self.intermediate_dense(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 172.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 586.00 MiB is free. Of the allocated memory 14.66 GiB is allocated by PyTorch, and 219.01 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-03-28 18:43:54,701 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_cudnn_benchmarking, disable_jit_profiling, allow_tf32]
2025-03-28 18:43:54,702 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 18:43:54,702 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 18:43:54,702 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 18:43:54,712 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-28 18:43:54,869 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 18:43:54,998 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 18:43:54,999 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 18:43:55,000 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 18:43:55,000 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 18:43:55,023 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:43:55,023 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 18:43:55,023 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:43:55,024 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 18:43:55,163 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 18:43:55,297 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 18:43:55,335 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 18:43:55,337 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 18:43:55,338 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 18:43:55,339 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-28 18:43:55,810 - speechbrain.utils.epoch_loop - INFO - Going into epoch 9
2025-03-28 18:43:55,830 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:43:55,832 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:44:04,727 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1822, in forward
    encoder_outputs = self.encoder(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1060, in forward
    layer_outputs = layer(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 942, in forward
    hidden_states = hidden_states + self.feed_forward(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 914, in forward
    hidden_states = self.output_dropout(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/dropout.py", line 70, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/functional.py", line 1425, in dropout
    _VF.dropout_(input, p, training) if inplace else _VF.dropout(input, p, training)
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 34.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 428.00 MiB is free. Of the allocated memory 14.83 GiB is allocated by PyTorch, and 199.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-03-28 18:44:27,304 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-03-28 18:44:27,304 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 18:44:27,305 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 18:44:27,305 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 18:44:27,323 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-28 18:44:27,463 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 18:44:27,603 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 18:44:27,604 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 18:44:27,605 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 18:44:27,605 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 18:44:27,621 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 18:44:27,629 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:44:27,629 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 18:44:27,629 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:44:27,939 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 18:44:27,941 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 18:44:27,941 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 18:44:27,943 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-28 18:44:27,963 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 18:44:28,090 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 18:44:28,408 - speechbrain.utils.epoch_loop - INFO - Going into epoch 9
2025-03-28 18:44:28,428 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:44:28,429 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:45:06,470 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1822, in forward
    encoder_outputs = self.encoder(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1060, in forward
    layer_outputs = layer(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 935, in forward
    hidden_states, attn_weights, _ = self.attention(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 861, in forward
    attn_output = torch.nn.functional.scaled_dot_product_attention(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 772.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 450.00 MiB is free. Of the allocated memory 14.67 GiB is allocated by PyTorch, and 343.52 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-03-28 18:50:42,702 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_cudnn_benchmarking, allow_tf32, disable_jit_profiling]
2025-03-28 18:50:42,702 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 18:50:42,702 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 18:50:42,702 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 18:50:42,942 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-28 18:50:42,987 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 18:50:42,989 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 18:50:42,989 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 18:50:42,990 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 18:50:43,011 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:50:43,011 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 18:50:43,011 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 18:50:43,087 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 18:50:43,313 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 18:50:43,315 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 18:50:43,315 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 18:50:43,316 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-28 18:50:43,463 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 18:50:43,597 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 18:50:43,731 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 18:50:43,779 - speechbrain.utils.epoch_loop - INFO - Going into epoch 9
2025-03-28 18:50:43,801 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:50:43,801 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 18:55:55,147 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1438, in _fit_train
    for batch in t:
  File "/home/zsombor/.local/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1480, in _next_data
    return self._process_data(data)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1505, in _process_data
    data.reraise()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/_utils.py", line 733, in reraise
    raise exception
AssertionError: Caught AssertionError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/dataio/dataset.py", line 167, in __getitem__
    return self.pipeline.compute_outputs({"id": data_id, **data_point})
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 507, in compute_outputs
    return self._compute(data, self._exec_order, self.output_mapping)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 539, in _compute
    values = item(*args)  # Call the DynamicItem to produce output
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/data_pipeline.py", line 73, in __call__
    return self.func(*args)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 171, in audio_pipeline
    assert os.path.exists(wav), f"File not found: {wav}"
AssertionError: File not found: ./MELD-wav16k/wav16k_train/dia0309_utt00.wav

2025-03-28 19:04:50,653 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_cudnn_benchmarking, disable_jit_profiling]
2025-03-28 19:04:50,653 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 19:04:50,653 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 19:04:50,653 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 19:04:50,802 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-28 19:04:50,935 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 19:04:50,937 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 19:04:50,938 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 19:04:50,938 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 19:04:50,958 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:04:50,958 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 19:04:50,958 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:04:50,996 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 19:04:51,257 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 19:04:51,259 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 19:04:51,259 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 19:04:51,260 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-28 19:04:51,374 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 19:04:51,509 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 19:04:51,719 - speechbrain.utils.epoch_loop - INFO - Going into epoch 9
2025-03-28 19:04:51,739 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:04:51,739 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:04:51,953 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 19:05:29,637 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1822, in forward
    encoder_outputs = self.encoder(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1060, in forward
    layer_outputs = layer(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 935, in forward
    hidden_states, attn_weights, _ = self.attention(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 861, in forward
    attn_output = torch.nn.functional.scaled_dot_product_attention(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 772.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 450.00 MiB is free. Of the allocated memory 14.67 GiB is allocated by PyTorch, and 343.52 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-03-28 19:16:45,471 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_cudnn_benchmarking, allow_tf32, disable_jit_profiling]
2025-03-28 19:16:45,471 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 19:16:45,471 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 19:16:45,471 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 19:16:45,493 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-28 19:16:45,857 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 19:16:45,863 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 19:16:45,865 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 19:16:45,866 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 19:16:45,866 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 19:16:45,890 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:16:45,890 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 19:16:45,890 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:16:46,008 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 19:16:46,147 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 19:16:46,267 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 19:16:46,269 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 19:16:46,269 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 19:16:46,271 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-28 19:16:46,285 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 19:16:46,798 - speechbrain.utils.epoch_loop - INFO - Going into epoch 9
2025-03-28 19:16:46,817 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:16:46,818 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:23:14,895 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:23:14,898 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:23:31,432 - speechbrain.nnet.schedulers - INFO - Changing lr from 5.3e-05 to 4.8e-05
2025-03-28 19:23:31,433 - speechbrain.nnet.schedulers - INFO - Changing lr from 5.3e-06 to 4.8e-06
2025-03-28 19:23:31,433 - speechbrain.utils.train_logger - INFO - Epoch: 9, lr: 5.31e-05, wave2vec_lr: 5.31e-06 - train loss: 1.56 - valid loss: 1.65, valid error_rate: 5.76e-01
2025-03-28 19:23:36,450 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-28+19-23-31+00
2025-03-28 19:23:37,702 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-27+21-15-41+00
2025-03-28 19:23:37,702 - speechbrain.utils.epoch_loop - INFO - Going into epoch 10
2025-03-28 19:23:37,730 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:23:37,732 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:23:40,948 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1242, in fit_batch
    scaled_loss.backward()
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
2025-03-28 19:24:02,287 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, disable_cudnn_benchmarking, allow_tf32]
2025-03-28 19:24:02,287 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 19:24:02,287 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 19:24:02,287 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 19:24:02,367 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 19:24:02,519 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 19:24:02,676 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 19:24:02,692 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 19:24:02,694 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 19:24:02,695 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 19:24:02,695 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 19:24:02,716 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:24:02,716 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 19:24:02,716 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:24:02,811 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 19:24:03,014 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 19:24:03,017 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 19:24:03,018 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 19:24:03,019 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-23-31+00
2025-03-28 19:24:03,399 - speechbrain.utils.epoch_loop - INFO - Going into epoch 10
2025-03-28 19:24:03,444 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:24:03,444 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:30:13,176 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:30:13,179 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:30:31,030 - speechbrain.nnet.schedulers - INFO - Changing lr from 4.8e-05 to 4.3e-05
2025-03-28 19:30:31,030 - speechbrain.nnet.schedulers - INFO - Changing lr from 4.8e-06 to 4.3e-06
2025-03-28 19:30:31,031 - speechbrain.utils.train_logger - INFO - Epoch: 10, lr: 4.78e-05, wave2vec_lr: 4.78e-06 - train loss: 1.55 - valid loss: 1.63, valid error_rate: 5.76e-01
2025-03-28 19:30:32,301 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-28+19-30-31+00
2025-03-28 19:30:32,332 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-28+19-23-31+00
2025-03-28 19:30:32,332 - speechbrain.utils.epoch_loop - INFO - Going into epoch 11
2025-03-28 19:30:32,355 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:30:32,356 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:30:35,434 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 32, in compute_forward
    outputs = self.hparams.avg_pool(outputs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/nnet/pooling.py", line 314, in forward
    actual_size = int(torch.round(lengths[snt_id] * x.shape[1]))
KeyboardInterrupt
2025-03-28 19:30:56,571 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_cudnn_benchmarking, disable_jit_profiling, allow_tf32]
2025-03-28 19:30:56,572 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 19:30:56,572 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 19:30:56,572 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 19:30:56,972 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 19:30:56,974 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 19:30:56,975 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 19:30:56,975 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 19:30:56,995 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:30:56,995 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 19:30:56,996 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:30:57,168 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 19:30:57,293 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 19:30:57,295 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 19:30:57,296 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 19:30:57,297 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-30-31+00
2025-03-28 19:30:57,349 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 19:30:57,484 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 19:30:57,615 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 19:30:57,920 - speechbrain.utils.epoch_loop - INFO - Going into epoch 11
2025-03-28 19:30:57,940 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:30:57,941 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:33:47,499 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1235, in fit_batch
    outputs = self.compute_forward(batch, sb.Stage.TRAIN)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1822, in forward
    encoder_outputs = self.encoder(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1060, in forward
    layer_outputs = layer(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 935, in forward
    hidden_states, attn_weights, _ = self.attention(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 861, in forward
    attn_output = torch.nn.functional.scaled_dot_product_attention(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 370.00 MiB. GPU 0 has a total capacity of 15.98 GiB of which 342.00 MiB is free. Of the allocated memory 14.93 GiB is allocated by PyTorch, and 190.19 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-03-28 19:34:09,495 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-03-28 19:34:09,495 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 19:34:09,495 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 19:34:09,495 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 19:34:09,523 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-03-28 19:34:09,679 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 19:34:09,788 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 19:34:09,790 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 19:34:09,791 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 19:34:09,791 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 19:34:09,811 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:34:09,811 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 19:34:09,811 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:34:09,858 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 19:34:09,993 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 19:34:10,119 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 19:34:10,121 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 19:34:10,123 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 19:34:10,123 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 19:34:10,124 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-30-31+00
2025-03-28 19:34:13,774 - speechbrain.utils.epoch_loop - INFO - Going into epoch 11
2025-03-28 19:34:13,799 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:34:13,801 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:40:43,027 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:40:43,030 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:41:02,781 - speechbrain.nnet.schedulers - INFO - Changing lr from 4.3e-05 to 3.9e-05
2025-03-28 19:41:02,781 - speechbrain.nnet.schedulers - INFO - Changing lr from 4.3e-06 to 3.9e-06
2025-03-28 19:41:02,782 - speechbrain.utils.train_logger - INFO - Epoch: 11, lr: 4.30e-05, wave2vec_lr: 4.30e-06 - train loss: 1.54 - valid loss: 1.63, valid error_rate: 5.76e-01
2025-03-28 19:41:04,074 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-28+19-41-02+00
2025-03-28 19:41:04,212 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-28+19-30-31+00
2025-03-28 19:41:04,212 - speechbrain.utils.epoch_loop - INFO - Going into epoch 12
2025-03-28 19:41:04,239 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:41:04,242 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:41:09,849 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1248, in fit_batch
    return loss.detach().cpu()
KeyboardInterrupt
2025-03-28 19:41:53,996 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_jit_profiling, disable_cudnn_benchmarking]
2025-03-28 19:41:53,996 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-03-28 19:41:53,996 - speechbrain.core - INFO - Beginning experiment!
2025-03-28 19:41:53,996 - speechbrain.core - INFO - Experiment folder: results/1993
2025-03-28 19:41:54,145 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-03-28 19:41:54,322 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-03-28 19:41:54,379 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-03-28 19:41:54,381 - speechbrain.utils.superpowers - DEBUG - 3e0ca38


2025-03-28 19:41:54,382 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-03-28 19:41:54,382 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-03-28 19:41:54,402 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:41:54,402 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-03-28 19:41:54,402 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-03-28 19:41:54,456 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-03-28 19:41:54,590 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-03-28 19:41:54,710 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-03-28 19:41:54,712 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-03-28 19:41:54,713 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-03-28 19:41:54,714 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-41-02+00
2025-03-28 19:41:55,182 - speechbrain.utils.epoch_loop - INFO - Going into epoch 12
2025-03-28 19:41:55,204 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:41:55,205 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:48:38,252 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:48:38,254 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:48:58,798 - speechbrain.nnet.schedulers - INFO - Changing lr from 3.9e-05 to 3.5e-05
2025-03-28 19:48:58,799 - speechbrain.nnet.schedulers - INFO - Changing lr from 3.9e-06 to 3.5e-06
2025-03-28 19:48:58,799 - speechbrain.utils.train_logger - INFO - Epoch: 12, lr: 3.87e-05, wave2vec_lr: 3.87e-06 - train loss: 1.54 - valid loss: 1.64, valid error_rate: 5.76e-01
2025-03-28 19:48:59,903 - speechbrain.utils.checkpoints - INFO - Saved an end-of-epoch checkpoint in results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-03-28 19:48:59,988 - speechbrain.utils.checkpoints - INFO - Deleted checkpoint in results/1993/save/CKPT+2025-03-28+19-41-02+00
2025-03-28 19:48:59,988 - speechbrain.utils.epoch_loop - INFO - Going into epoch 13
2025-03-28 19:49:00,010 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:49:00,012 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-03-28 19:49:46,235 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 257, in <module>
    emo_id_brain.fit(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1619, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1444, in _fit_train
    loss = self.fit_batch(batch)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1248, in fit_batch
    return loss.detach().cpu()
KeyboardInterrupt
2025-04-02 20:08:37,599 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_cudnn_benchmarking, allow_tf32, disable_jit_profiling]
2025-04-02 20:08:37,600 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:08:37,600 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:08:37,600 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:08:37,776 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:08:37,954 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:08:38,037 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:08:38,039 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:08:38,040 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:08:38,040 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:08:38,075 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:08:38,075 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:08:38,076 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:08:38,103 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:08:38,264 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:08:40,329 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:08:40,331 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:08:40,332 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:08:40,333 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:08:41,663 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:08:41,665 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:08:45,100 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 260, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1799, in evaluate
    loss = self.evaluate_batch(batch, stage=Stage.TEST)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1408, in evaluate_batch
    out = self.compute_forward(batch, stage=stage)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1808, in forward
    extract_features = self.feature_extractor(input_values)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 463, in forward
    hidden_states = conv_layer(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 361, in forward
    hidden_states = self.layer_norm(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 313, in forward
    return F.group_norm(input, self.num_groups, self.weight, self.bias, self.eps)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/functional.py", line 2965, in group_norm
    return torch.group_norm(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 10.04 GiB. GPU 0 has a total capacity of 15.98 GiB of which 4.65 GiB is free. Of the allocated memory 10.65 GiB is allocated by PyTorch, and 215.36 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-04-02 20:09:20,697 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-04-02 20:09:20,697 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:09:20,697 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:09:20,697 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:09:20,901 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:09:21,002 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:09:21,004 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:09:21,004 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:09:21,004 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:09:21,026 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:09:21,026 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:09:21,026 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:09:21,071 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:09:21,233 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:09:21,341 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:09:21,343 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:09:21,344 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:09:21,344 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:09:21,541 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:09:21,541 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:09:24,843 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 260, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1799, in evaluate
    loss = self.evaluate_batch(batch, stage=Stage.TEST)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1408, in evaluate_batch
    out = self.compute_forward(batch, stage=stage)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 29, in compute_forward
    outputs = self.modules.wav2vec2(wavs, lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 153, in forward
    return self.extract_features(wav, wav_lens)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/lobes/models/huggingface_transformers/wav2vec2.py", line 177, in extract_features
    out = self.model(
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1808, in forward
    extract_features = self.feature_extractor(input_values)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 463, in forward
    hidden_states = conv_layer(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 361, in forward
    hidden_states = self.layer_norm(hidden_states)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 313, in forward
    return F.group_norm(input, self.num_groups, self.weight, self.bias, self.eps)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/nn/functional.py", line 2965, in group_norm
    return torch.group_norm(
torch.OutOfMemoryError: HIP out of memory. Tried to allocate 10.04 GiB. GPU 0 has a total capacity of 15.98 GiB of which 4.65 GiB is free. Of the allocated memory 10.65 GiB is allocated by PyTorch, and 215.36 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_HIP_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-04-02 20:12:13,725 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-04-02 20:12:13,725 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:12:13,725 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:12:13,725 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:12:13,741 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-04-02 20:12:13,908 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:12:14,035 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:12:14,037 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:12:14,037 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:12:14,037 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:12:14,058 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:12:14,058 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:12:14,058 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:12:14,368 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:12:14,370 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:12:14,371 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:12:14,371 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:12:14,552 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:12:14,553 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:12:15,297 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:12:15,528 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:12:15,698 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:13:00,619 - speechbrain.utils.train_logger - INFO - Epoch loaded: 12 - test loss: 1.53, test error_rate: 5.19e-01
2025-04-02 20:31:18,009 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_jit_profiling, disable_cudnn_benchmarking]
2025-04-02 20:31:18,009 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:31:18,009 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:31:18,009 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:31:18,317 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:31:18,319 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:31:18,319 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:31:18,319 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:31:18,342 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:31:18,343 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:31:18,343 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:31:18,671 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:31:18,673 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:31:18,674 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:31:18,675 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:31:18,842 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 260, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1788, in evaluate
    self.on_stage_start(Stage.TEST, epoch=None)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 70, in on_stage_start
    self.error_metrics = self.hparams.error_stats()
TypeError: ClassificationStats.__init__() got an unexpected keyword argument 'metric'
2025-04-02 20:31:21,476 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base HTTP/1.1" 200 2380
2025-04-02 20:31:21,663 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-04-02 20:31:21,858 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:31:22,061 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:31:22,240 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:31:22,393 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:31:55,512 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, disable_cudnn_benchmarking, allow_tf32]
2025-04-02 20:31:55,512 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:31:55,512 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:31:55,512 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:31:55,673 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base HTTP/1.1" 200 2380
2025-04-02 20:31:55,805 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:31:55,807 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:31:55,808 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:31:55,808 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:31:55,829 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:31:55,829 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:31:55,829 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:31:55,860 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-04-02 20:31:56,034 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:31:56,142 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:31:56,144 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:31:56,144 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:31:56,145 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:31:56,271 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:31:56,334 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:31:56,335 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:31:56,453 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:31:56,690 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:32:42,930 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 260, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1806, in evaluate
    self.on_stage_end(Stage.TEST, avg_test_loss, None)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 93, in on_stage_end
    "error_rate": self.error_metrics.summarize("average"),
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/metric_stats.py", line 1066, in summarize
    self._build_lookups()
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/utils/metric_stats.py", line 1094, in _build_lookups
    sorted(set(prediction for prediction in self.predictions))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous
2025-04-02 20:35:27,975 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-04-02 20:35:27,975 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:35:27,975 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:35:27,975 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:35:28,005 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base HTTP/1.1" 200 2380
2025-04-02 20:35:28,226 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-04-02 20:35:28,279 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:35:28,281 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:35:28,281 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:35:28,282 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:35:28,303 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:35:28,303 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:35:28,303 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:35:28,408 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:35:28,579 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:35:28,620 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:35:28,622 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:35:28,623 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:35:28,625 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:35:28,736 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:35:28,783 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 260, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1788, in evaluate
    self.on_stage_start(Stage.TEST, epoch=None)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 70, in on_stage_start
    self.error_metrics = self.hparams.error_stats()
TypeError: ClassificationStats.__init__() got an unexpected keyword argument 'metric'
2025-04-02 20:35:28,891 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:37:11,139 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_cudnn_benchmarking, allow_tf32, disable_jit_profiling]
2025-04-02 20:37:11,139 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:37:11,139 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:37:11,139 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:37:11,352 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:37:11,445 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:37:11,446 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:37:11,447 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:37:11,447 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:37:11,468 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:37:11,468 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:37:11,468 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:37:11,544 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:37:11,696 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:37:11,782 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:37:11,784 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:37:11,784 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:37:11,785 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:37:11,860 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:37:11,951 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 266, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1788, in evaluate
    self.on_stage_start(Stage.TEST, epoch=None)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 70, in on_stage_start
    self.error_metrics = self.hparams.error_stats()
TypeError: ClassificationStats.__init__() got an unexpected keyword argument 'metric'
2025-04-02 20:38:01,980 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-04-02 20:38:01,980 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:38:01,980 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:38:01,980 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:38:02,047 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:38:02,224 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:38:02,287 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:38:02,288 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:38:02,289 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:38:02,289 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:38:02,310 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:38:02,310 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:38:02,310 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:38:02,384 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:38:02,541 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:38:02,630 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:38:02,632 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:38:02,633 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:38:02,634 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:38:02,821 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:38:02,822 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:38:03,273 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 266, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1799, in evaluate
    loss = self.evaluate_batch(batch, stage=Stage.TEST)
  File "/home/zsombor/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1409, in evaluate_batch
    loss = self.compute_objectives(out, batch, stage=stage)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 48, in compute_objectives
    self.error_metrics.append(batch.id, predictions, emoid)
AttributeError: 'EmoIdBrain' object has no attribute 'error_metrics'
2025-04-02 20:38:38,637 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, disable_cudnn_benchmarking, allow_tf32]
2025-04-02 20:38:38,638 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:38:38,638 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:38:38,638 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:38:38,945 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:38:38,946 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:38:38,947 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:38:38,947 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:38:38,968 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:38:38,968 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:38:38,968 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:38:39,289 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:38:39,291 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:38:39,291 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:38:39,292 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:38:39,482 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:38:39,483 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:38:39,842 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:38:40,039 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:38:40,200 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:38:40,350 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:39:25,466 - speechbrain.utils.train_logger - INFO - Epoch loaded: 12 - test loss: 1.53
2025-04-02 20:40:57,758 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_cudnn_benchmarking, disable_jit_profiling, allow_tf32]
2025-04-02 20:40:57,759 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:40:57,759 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:40:57,759 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:40:57,855 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-04-02 20:40:58,027 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:40:58,070 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:40:58,072 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:40:58,072 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:40:58,073 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:40:58,094 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:40:58,094 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:40:58,094 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:40:58,391 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:40:58,409 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:40:58,411 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:40:58,411 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:40:58,412 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:40:58,563 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:40:58,604 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:40:58,605 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:40:58,733 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:41:44,636 - speechbrain.utils.train_logger - INFO - Epoch loaded: 12 - test loss: 1.53
2025-04-02 20:43:15,696 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, disable_cudnn_benchmarking, allow_tf32]
2025-04-02 20:43:15,696 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:43:15,696 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:43:15,696 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:43:16,009 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:43:16,010 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:43:16,011 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:43:16,011 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:43:16,034 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:43:16,034 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:43:16,034 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:43:16,358 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:43:16,360 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:43:16,360 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:43:16,361 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:43:16,425 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base HTTP/1.1" 200 2380
2025-04-02 20:43:16,527 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 266, in <module>
    test_stats = emo_id_brain.evaluate(
  File "/home/zsombor/.local/lib/python3.10/site-packages/speechbrain/core.py", line 1788, in evaluate
    self.on_stage_start(Stage.TEST, epoch=None)
  File "/home/zsombor/MELD_speechbrain/train_with_wav2vec2.py", line 70, in on_stage_start
    self.error_metrics = self.hparams.error_stats()
TypeError: ClassificationStats.__init__() got an unexpected keyword argument 'metric'
2025-04-02 20:43:16,615 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-04-02 20:43:16,794 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:43:16,973 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:43:17,134 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:43:17,296 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:44:30,107 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [disable_jit_profiling, allow_tf32, disable_cudnn_benchmarking]
2025-04-02 20:44:30,108 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-02 20:44:30,108 - speechbrain.core - INFO - Beginning experiment!
2025-04-02 20:44:30,108 - speechbrain.core - INFO - Experiment folder: results/1993
2025-04-02 20:44:30,125 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/main HTTP/1.1" 200 5760
2025-04-02 20:44:30,314 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/discussions?p=0 HTTP/1.1" 200 6369
2025-04-02 20:44:30,414 - speechbrain.utils.superpowers - DEBUG - amdsmi @ file:///opt/rocm-6.3.2/share/amd_smi
apturl==0.5.2
argcomplete==1.8.1
audioread==3.0.1
bcrypt==3.2.0
black==24.3.0
blinker==1.4
Brlapi==0.8.3
certifi==2025.1.31
cffi==1.17.1
cfgv==3.4.0
chardet==4.0.0
charset-normalizer==3.4.1
click==8.1.7
colorama==0.4.4
command-not-found==0.3
cryptography==3.4.8
cupshelpers==1.0
dbus-python==1.2.18
decorator==5.2.1
defer==1.0.6
distlib==0.3.9
distro==1.7.0
distro-info==1.1+ubuntu0.2
docstring_parser_fork==0.0.12
duplicity==0.8.21
exceptiongroup==1.2.2
fasteners==0.14.1
filelock==3.18.0
flake8==7.0.0
fsspec==2025.3.0
future==0.18.2
httplib2==0.20.2
huggingface-hub==0.29.2
HyperPyYAML==1.2.2
identify==2.6.9
idna==3.10
importlib-metadata==4.6.4
iniconfig==2.0.0
isort==5.13.2
jeepney==0.7.1
Jinja2==3.1.4
joblib==1.4.2
keyring==23.5.0
language-selector==0.1
launchpadlib==1.10.16
lazr.restfulclient==0.14.4
lazr.uri==1.0.6
lazy_loader==0.4
librosa==0.10.2.post1
llvmlite==0.44.0
lockfile==0.12.2
louis==3.20.0
macaroonbakery==1.3.1
Mako==1.1.3
MarkupSafe==3.0.2
mccabe==0.7.0
monotonic==1.6
more-itertools==8.10.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
netifaces==0.11.0
networkx==3.4.2
nodeenv==1.9.1
numba==0.61.0
numpy==2.2.4
nvidia-cublas-cu12==12.4.5.8
nvidia-cuda-cupti-cu12==12.4.127
nvidia-cuda-nvrtc-cu12==12.4.127
nvidia-cuda-runtime-cu12==12.4.127
nvidia-cufft-cu12==11.2.1.3
nvidia-curand-cu12==10.3.5.147
nvidia-cusparselt-cu12==0.6.2
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.4.127
oauthlib==3.2.0
olefile==0.46
packaging==24.2
pandas==2.2.3
paramiko==2.9.3
pathspec==0.12.1
pexpect==4.8.0
Pillow==9.0.1
platformdirs==4.3.6
pluggy==1.5.0
pooch==1.8.2
pre_commit==4.1.0
protobuf==3.12.4
ptyprocess==0.7.0
pycairo==1.20.1
pycodestyle==2.11.0
pycparser==2.22
pycups==2.0.1
pydoclint==0.4.1
pyflakes==3.2.0
PyGObject==3.42.1
pygtrie==2.5.0
PyJWT==2.3.0
pymacaroons==0.13.0
PyNaCl==1.5.0
pyparsing==2.4.7
pyRFC3339==1.1
pytest==7.4.0
python-apt==2.4.0+ubuntu4
python-dateutil==2.9.0.post0
python-debian==0.1.43+ubuntu1.1
pytorch-triton-rocm==3.2.0
pytz==2022.1
pyxdg==0.27
PyYAML==6.0.2
regex==2024.11.6
reportlab==3.6.8
requests==2.25.1
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
safetensors==0.5.3
scikit-learn==1.6.1
scipy==1.15.2
SecretStorage==3.3.1
sentencepiece==0.2.0
six==1.16.0
soundfile==0.13.1
soxr==0.5.0.post1
speechbrain==1.0.2
sympy==1.13.1
systemd-python==234
threadpoolctl==3.5.0
tokenizers==0.21.0
tomli==2.2.1
torch==2.6.0+rocm6.2.4
torchaudio==2.6.0+rocm6.2.4
torchvision==0.21.0+rocm6.2.4
tqdm==4.67.1
transformers==4.49.0
triton==3.2.0
typing_extensions==4.13.0
tzdata==2025.1
ubuntu-drivers-common==0.0.0
ubuntu-pro-client==8001
ufw==0.36.1
unattended-upgrades==0.1
urllib3==2.3.0
usb-creator==0.3.7
virtualenv==20.29.3
wadllib==1.3.6
xdg==5
xkit==0.0.0
yamllint==1.35.1
zipp==1.0.0

WARNING: Ignoring invalid distribution -cipy (/home/zsombor/.local/lib/python3.10/site-packages)

2025-04-02 20:44:30,416 - speechbrain.utils.superpowers - DEBUG - 397ff02


2025-04-02 20:44:30,417 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-02 20:44:30,417 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-02 20:44:30,440 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:44:30,440 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-02 20:44:30,440 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from label_encoder.txt
2025-04-02 20:44:30,503 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/facebook/wav2vec2-base/commits/refs%2Fpr%2F10 HTTP/1.1" 200 6725
2025-04-02 20:44:30,671 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors.index.json HTTP/1.1" 404 0
2025-04-02 20:44:30,760 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-02 20:44:30,762 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-02 20:44:30,762 - speechbrain.core - INFO - EmoIdBrain Model Statistics:
* Total Number of Trainable Parameters: 90.2M
* Total Number of Parameters: 94.4M
* Trainable Parameters represent 95.5493% of the total size.
2025-04-02 20:44:30,763 - speechbrain.utils.checkpoints - INFO - Loading a checkpoint from results/1993/save/CKPT+2025-03-28+19-48-58+00
2025-04-02 20:44:30,834 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /facebook/wav2vec2-base/resolve/refs%2Fpr%2F10/model.safetensors HTTP/1.1" 302 0
2025-04-02 20:44:30,953 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:44:30,955 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 7 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-02 20:45:17,230 - speechbrain.utils.train_logger - INFO - Epoch loaded: 12 - test loss: 1.53, test error_rate: 5.19e-01
